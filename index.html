<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Caleb's Creations</title>
<style>
body { font-family: Arial, sans-serif; margin:0; padding:0; background:#f9f9f9; }
.top-bar { background:#333; color:white; display:flex; justify-content:space-between; align-items:center; padding:15px 20px; position:sticky; top:0; z-index:1000;}
.top-left { font-size:20px; font-weight:bold;}
.top-right a { color:white; text-decoration:none; font-weight:bold;}
.container { max-width:800px; margin:auto; padding:20px;}
ul { list-style:none; padding:0; }
li { padding:10px; border-bottom:1px solid #ccc; display:flex; justify-content:space-between; align-items:center; background:white; margin-bottom:5px; border-radius:5px;}
.price { font-weight:bold; }
.add-cart-btn { cursor:pointer; margin-left:10px; padding:5px 10px; border-radius:3px; border:none; background-color:green; color:white;}
.cart { background:white; padding:10px; margin-top:20px; border-radius:5px; border:1px solid #ccc;}
.cart h3 { margin-top:0; }
.cart-item { display:flex; justify-content:space-between; margin-bottom:5px;}
.delete-btn { background-color:red; color:white; border:none; padding:5px 10px; border-radius:3px; cursor:pointer;}
.search-box { margin-bottom:15px;}
.search-box input { width:100%; padding:8px; font-size:16px;}
</style>
</head>
<body>

<div class="top-bar">
  <div class="top-left">Caleb's Creations</div>
  <div class="top-right">
    <a href="feeder-hub.html">Feeder Hub</a>
  </div>
</div>

<div class="container">
  <h2>Products</h2>
  <div class="search-box">
    <input type="text" id="searchInput" placeholder="Search products..." oninput="displayProducts()">
  </div>
  <ul id="product-list"></ul>

  <div class="cart">
    <h3>Shopping Cart</h3>
    <div id="cart-items"></div>
    <p><strong>Total: $<span id="cart-total">0.00</span></strong></p>
  </div>
</div>

<script>
// Load products from localStorage
let products = JSON.parse(localStorage.getItem('products')) || [];
let cart = [];

function displayProducts() {
  const list = document.getElementById('product-list');
  const search = document.getElementById('searchInput').value.toLowerCase();
  list.innerHTML = '';
  products.filter(p => p.name.toLowerCase().includes(search)).forEach((p, index) => {
    const li = document.createElement('li');
    li.innerHTML = `
      <span>${p.name} ${p.stock!==undefined?'(Stock: '+p.stock+')':''}</span>
      ${p.img?`<img src="${p.img}" width="50" height="50" style="margin-left:10px;">`:''}
      <span class="price">$${p.price.toFixed(2)}</span>
      <button class="add-cart-btn" onclick="addToCart(${index})">Add to Cart</button>
    `;
    list.appendChild(li);
  });
}

function addToCart(index) {
  const product = products[index];
  if(product.stock!==undefined && product.stock <=0){
    alert("Out of stock!");
    return;
  }
  cart.push(product);
  if(product.stock!==undefined) product.stock--; 
  displayCart();
  displayProducts();
  localStorage.setItem('products', JSON.stringify(products));
}

function displayCart() {
  const cartItems = document.getElementById('cart-items');
  cartItems.innerHTML = '';
  let total = 0;
  cart.forEach((item, idx) => {
    total += item.price;
    const div = document.createElement('div');
    div.className = 'cart-item';
    div.innerHTML = `<span>${item.name} - $${item.price.toFixed(2)}</span>
                     <button class="delete-btn" onclick="removeFromCart(${idx})">X</button>`;
    cartItems.appendChild(div);
  });
  document.getElementById('cart-total').textContent = total.toFixed(2);
}

function removeFromCart(idx) {
  const product = cart[idx];
  if(product.stock!==undefined) product.stock++;
  cart.splice(idx, 1);
  displayCart();
  displayProducts();
}

displayProducts();
displayCart();
</script>

</body>
</html>
